name: Static Checks
on:
    pull_request: {}
    push: {}
permissions:
  contents: read

jobs:
    go_lint:
        permissions:
          contents: read  # for actions/checkout to fetch code
          pull-requests: read  # for golangci/golangci-lint-action to fetch pull requests
        name: Go Lint
        runs-on: ubuntu-latest
        steps:
            - name: Harden Runner
              uses: step-security/harden-runner@128a63446a954579617e875aaab7d2978154e969 # v2.4.0
              with:
                egress-policy: audit

            - name: Set up Go 1.x
              uses: actions/setup-go@fac708d6674e30b6ba41289acaab6d4b75aa0753 # v4.0.1
              with:
                go-version: ^1.19
            - uses: actions/checkout@61b9e3751b92087fd0b06925ba6dd6314e06f089 # master
            - name: Run linter
              uses: golangci/golangci-lint-action@08e2f20817b15149a52b5b3ebe7de50aff2ba8c5 # v3.4.0
              with:
                  version: v1.51
                  args: -E=gofmt,deadcode,unused,varcheck,ineffassign,revive,misspell,exportloopref,asciicheck,bodyclose,depguard,dogsled,dupl,durationcheck,errname,forbidigo -D=staticcheck --timeout=30m0s
